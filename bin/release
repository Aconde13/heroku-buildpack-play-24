#!/usr/bin/env bash
# bin/release <build-dir>

BUILD_DIR="$1"

# Mensajes de debug SOLO a stderr (no contaminan el YAML)
echo ">>> [DEBUG] bin/release ejecutado (BUILD_DIR=$BUILD_DIR)" >&2

# Si la app NO trae Procfile, definimos el proceso web por defecto
if [ ! -f "$BUILD_DIR/Procfile" ]; then
  cat <<'YAML'
---
default_process_types:
  web: ./.play/play run --http.port=$PORT $PLAY_OPTS
YAML
else
  # Si hay Procfile, igual debemos emitir YAML válido (vacío)
  cat <<'YAML'
---
default_process_types: {}
YAML
fi
